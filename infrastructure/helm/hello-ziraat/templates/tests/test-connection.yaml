apiVersion: v1
kind: Pod
metadata:
  name: "{{ include "hello-ziraat.fullname" . }}-test-connection"
  labels:
    app.kubernetes.io/name: "{{ include "hello-ziraat.name" . }}"
    helm.sh/chart: "{{ include "hello-ziraat.chart" . }}"
    app.kubernetes.io/instance: "{{ .Release.Name }}"
    app.kubernetes.io/managed-by: "Helm"
spec:
  restartPolicy: Never
  containers:
    - name: backend-test
      image: curlimages/curl:7.85.0
      command: ["sh", "-c"]
      args:
        - |
          echo "Testing backend...";
          curl -v --fail http://{{ include "hello-ziraat.fullname" . }}-backend.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.backend.service.servicePort }};
    - name: frontend-test
      image: curlimages/curl:7.85.0
      command: ["sh", "-c"]
      args:
        - |
          echo "Testing frontend...";
          curl -v --fail http://{{ include "hello-ziraat.fullname" . }}-frontend.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.frontend.service.port }};
